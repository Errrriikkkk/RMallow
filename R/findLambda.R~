#' Update the Lambda parameters of each cluster of a Mallows Model.
#'
#' @param ranks An object of class "ranking".
#' @param top.bound If necessary, what is the top bound for the lambda parameters?
#' @param G Number of clusters in the model.
#' @param N Number of rows in the rankings.
#' @param z The current probabilities of cluster membership.
#' @return The updated lambda parameters, as a vector.
findLambda <- function(ranks, top.bound, G, N, z) {
  # For each cluster
  if(!is.list(ranks)) {
    ranks <- list(ranks)
  }
  abils <- ncol(ranks[[1]]@ranks)
  lambda <- 0*(1:G)
  for(i in 1:G) {
    N <- sum(z[, i])
    D <- sum(z[, i]*rowSums(ranks[[i]]@V, na.rm = TRUE))
    geqties <- colSums(z[, i]*ranks[[i]]@geqties.mat)
    rt <- uniroot(lambdaroot, interval = c(1e-10, 0.9999999999), N = N, 
                  D = D, geqties = geqties, 
                  abils = abils, tol = 1e-10)$root
    lambda[i] <- -log(rt)
  }
  return(lambda)
}

