#' Calculate the likelihood of a set of data in a GMM using
#' @param ps Proportion of the data which was drawn from each cluster.
#' @param thetas matrix of theta parameters for each cluster
#' @param ranks a list of objects of class 'ranking', as generated by RMallow,
#' one for each cluster.
#' @return The log-likelihood of the parameters, given the data.
likelihoodGMM <- function(ps, thetas, ranks) {
  pvals <- log(rowSums(t(ps*t(pRank(ranks, thetas)))))
  return(sum(pvals))
}
